# CBD_Stone

Machine Learning-Based Decision-Making Tool for Improved Choledocholithiasis Prediction and Management

## Background
The suboptimal accuracy of guidelines for predicting choledocholithiasis (CDL) has led to uncertainty regarding appropriate diagnostic or therapeutic interventions and overutilization of endoscopic retrograde cholangiopancreatography (ERCP). Improved predictive models may help triage patients to modalities associated with lower procedural risk and decreased healthcare expenditure.
## Methods
A prediction model was created utilizing a gradient boosting machine algorithm to estimate the probability of CDL based on clinical presenting features. The model was trained using a cohort of patients presenting to a tertiary care hospital and affiliated community centers with symptoms suggestive of choledocholithiasis. The data split for testing-training was 20-80. Model performance was evaluated by testing accuracy, 10-fold cross-validation, and area under the receiver operating characteristic curve (AUC). A nearest-neighbor imputation approach was implemented to address missing values in the dataset, with an added indicator column to denote whether the original value was missing. A second decision-making tool utilized the probability of CDL to suggest next steps in clinical management, with low risk patients triaged to cholecystectomy with intra-operative cholangiogram (CCY + IOC), intermediate-low risk patients triaged to magnetic resonance cholangiopancreatography (MRCP), intermediate-high risk patients triaged to endoscopic ultrasound (EUS), and high risk patients triaged to ERCP.
## Results
2342 patients (mean age 56.7 years; 61% female) were included in the model and 46% had CDL. Guided by prior literature and clinical practice, variables most predictive of CDL included the degree of total bilirubin and other liver enzyme elevations, presence of CBD stone on imaging, and patient age. The model demonstrated 86% accuracy and 85% precision in distinguishing CDL risk, with an AUC of 95%. The decision-making tree suggested MRCP for 14% of patients, ERCP for 36% of patients, EUS for 12% and CCY + IOC for 37% patients. This approach missed only 1% of common bile duct (CBD) stones (5/469 test set patients) by suggesting CCY + IOC. It assigned only 2.5% (12/469) patients without CBD stones to ERCP, compared to 13.8% using ASGE 2019 guidelines.
## Conclusions
These machine-learning models offer an individualized risk assessment for choledocholithiasis and suggested next steps in management based on clinical parameters available at initial presentation. Risk stratification enables low-risk patients to undergo cholecystectomy without further imaging, while reserving advanced imaging (e.g., MRCP) for intermediate-risk patients and prioritizing high-risk patients for ERCP. By improving upon the accuracy of existing guidelines, this model has the potential to reduce procedural morbidity and promote cost-effective, high-value care for patients with biliary disease.
